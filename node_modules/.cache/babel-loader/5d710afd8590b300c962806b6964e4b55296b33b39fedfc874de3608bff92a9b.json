{"ast":null,"code":"import _regeneratorRuntime from\"F:/LBI/FE_BI/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"F:/LBI/FE_BI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"F:/LBI/FE_BI/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import axios from\"axios\";import DatePicker from\"react-datepicker\";import\"react-datepicker/dist/react-datepicker.css\";import{useNavigate,useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddPelanggaran=function AddPelanggaran(){var _ref,_ref2;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),keterangan=_useState2[0],setKeterangan=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),Kurangpoint=_useState4[0],setKurangpoint=_useState4[1];var navigate=useNavigate();var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUser=_useState6[1];var _useParams=useParams(),id=_useParams.id;useEffect(function(){getUserById();},[]);var getUserById=function getUserById(){return(_ref=_ref||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"http://localhost:5000/users/\".concat(id));case 2:response=_context.sent;setUser(response.data);case 4:case\"end\":return _context.stop();}},_callee);}))).apply(this,arguments);};var savePelanggaran=function savePelanggaran(_x){return(_ref2=_ref2||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var totalKurangPoint,updatedPoint;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:e.preventDefault();// Menghitung jumlah point yang akan dikurangkan\ntotalKurangPoint=parseInt(Kurangpoint,10);// Memastikan total pengurangan point tidak kurang dari 0\nif(!(totalKurangPoint<0||totalKurangPoint>100)){_context2.next=5;break;}alert(\"Pengurangan point harus diantara 0 dan 100.\");return _context2.abrupt(\"return\");case 5:if(!(users.point-totalKurangPoint<0)){_context2.next=8;break;}alert(\"Pengurangan point Gagal.\");return _context2.abrupt(\"return\");case 8:_context2.prev=8;_context2.next=11;return axios.post(\"http://localhost:5000/pelanggarans\",{user:users._id,date:selectedDate,keterangan:keterangan,Kurangpoint:totalKurangPoint// Menggunakan totalKurangPoint yang sudah dihitung\n});case 11:// Pengurangan point dari user\nupdatedPoint=users.point-totalKurangPoint;_context2.next=14;return axios.patch(\"http://localhost:5000/users/\".concat(id),{point:updatedPoint});case 14:// Navigasi kembali ke halaman utama setelah berhasil\nnavigate(\"/\");_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](8);console.error(_context2.t0);case 20:case\"end\":return _context2.stop();}},_callee2,null,[[8,17]]);}))).apply(this,arguments);};var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),selectedDate=_useState8[0],setSelectedDate=_useState8[1];var handleDateChange=function handleDateChange(date){setSelectedDate(date);};return/*#__PURE__*/_jsx(\"div\",{className:\"box\",style:{width:\"50%\",margin:\"0 auto\",marginTop:\"50px\",paddingBottom:\"70px\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"columns mt-5 is-centered\",children:/*#__PURE__*/_jsx(\"div\",{className:\"column is-half\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:savePelanggaran,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Input Tanggal\"}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(DatePicker,{selected:selectedDate,className:\"input\",onChange:handleDateChange,dateFormat:\"dd/MM/yyyy\"// Format tampilan tanggal dengan jam, menit, dan detik\n,isClearable:true// Membuat opsi untuk menghapus tanggal\n})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Keterangan\"}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input\",value:keterangan,onChange:function onChange(e){return setKeterangan(e.target.value);},placeholder:\"Keterangan\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Point\"}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input\",value:Kurangpoint,onChange:function onChange(e){return setKurangpoint(e.target.value);},placeholder:\"Point\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"button is-success\",type:\"submit\",children:\"Tambah\"}),/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"button is-normal is-danger ml-2\",children:\"Menu Utama\"})]})]})})})});};export default AddPelanggaran;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}