{"ast":null,"code":"import _regeneratorRuntime from\"F:/LBI/FE_BI/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"F:/LBI/FE_BI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"F:/LBI/FE_BI/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{useParams,Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DetailUser=function DetailUser(){var _ref;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),pelanggarans=_useState4[0],setPelanggarans=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),Kurangpoint=_useState6[0],setKurangpoint=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),name=_useState8[0],setName=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),email=_useState10[0],setEmail=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),point=_useState12[0],setPoint=_useState12[1];var _useParams=useParams(),id=_useParams.id;// Tambahkan state loading untuk menunjukkan bahwa data sedang diambil\nvar _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),loading=_useState14[0],setLoading=_useState14[1];useEffect(function(){// Mengambil data pengguna berdasarkan ID\naxios.get(\"http://localhost:5000/users/\".concat(id)).then(function(response){setName(response.data.name);setEmail(response.data.email);setPoint(response.data.point);setUser(response.data);setLoading(false);// Set loading menjadi false setelah data diterima\n}).catch(function(error){console.error(\"Error fetching user data:\",error);});// Mengambil semua data pelanggaran\naxios.get(\"http://localhost:5000/pelanggarans\").then(function(response){// Menerapkan filter pada pelanggaran berdasarkan ID pengguna\nvar filteredPelanggarans=response.data.filter(function(pelanggaran){return pelanggaran.user===id;});setPelanggarans(filteredPelanggarans);}).catch(function(error){console.error(\"Error fetching pelanggaran data:\",error);});},[id]);// Untuk mengubah format tanggal\nfunction formatDate(dateString){var options={year:\"numeric\",month:\"2-digit\",day:\"2-digit\"};var dateObj=new Date(dateString);return dateObj.toLocaleDateString(\"en-US\",options);}var deletePelanggaran=function deletePelanggaran(_x){return(_ref=_ref||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(pelanggaranId){var deletedPelanggaran,totalKurangPoint,updatedPoint;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;deletedPelanggaran=pelanggarans.find(function(pelanggaran){return pelanggaran._id===pelanggaranId;});totalKurangPoint=parseInt(deletedPelanggaran.Kurangpoint,10);// Mengirim permintaan DELETE untuk menghapus pelanggaran\n_context.next=5;return axios.delete(\"http://localhost:5000/pelanggarans/\".concat(pelanggaranId));case 5:// Menambahkan totalKurangPoint ke point pengguna\nupdatedPoint=point+totalKurangPoint;// Mengirim permintaan PATCH untuk memperbarui point pengguna\n_context.next=8;return axios.patch(\"http://localhost:5000/users/\".concat(id),{point:updatedPoint});case 8:// Setelah pembaruan berhasil, perbarui state\nsetPoint(updatedPoint);// Menghapus pelanggaran dari daftar pelanggarans\nsetPelanggarans(function(prevPelanggarans){return prevPelanggarans.filter(function(pelanggaran){return pelanggaran._id!==pelanggaranId;});});_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error(\"Error deleting pelanggaran:\",_context.t0);case 15:case\"end\":return _context.stop();}},_callee,null,[[0,12]]);}))).apply(this,arguments);};return/*#__PURE__*/_jsxs(\"div\",{className:\"box\",style:{width:\"75%\",margin:\"0 auto\",marginTop:\"50px\",paddingBottom:\"70px\"},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:\"center\",fontSize:\"2rem\",marginBottom:\"30px\"},children:\"Detail Informasi Pelanggaran\"})}),loading?/*#__PURE__*/ // Tampilkan pesan loading jika data sedang diambil\n_jsx(\"p\",{children:\"Data Sedang Di Proses...\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-1\",children:\"Nama :\"}),/*#__PURE__*/_jsx(\"div\",{className:\"column\",children:name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-1\",children:\"Email :\"}),/*#__PURE__*/_jsx(\"div\",{className:\"column\",children:email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-1\",children:\"Point :\"}),/*#__PURE__*/_jsx(\"div\",{className:\"column\",children:point})]}),/*#__PURE__*/_jsx(\"div\",{className:\"container mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"columns is-centered\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"column is-four-fifths\",children:[/*#__PURE__*/_jsx(Link,{to:\"add/pelanggaran/\",className:\"button is-primary is-rounded\",children:\"Tambah\"}),/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"button is-normal is-danger ml-2 is-rounded\",children:\"Menu Utama\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-fullwidth is-striped is-hoverable is-responsive\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"No\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Tanggal\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Pelanggaran\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Pengurangan Point\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:pelanggarans.map(function(pelanggaran,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:formatDate(pelanggaran.date)}),/*#__PURE__*/_jsx(\"td\",{children:pelanggaran.keterangan}),/*#__PURE__*/_jsx(\"td\",{children:pelanggaran.Kurangpoint}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return deletePelanggaran(pelanggaran._id);},className:\"button is-danger is-rounded\",children:\"Delete\"})})]},pelanggaran._id);})})]})})]})})})]})]});};export default DetailUser;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}